<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <title>Least Squares</title>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
<h1>Least Squares</h1>
<p>
The least squares problem is to find an \(n\)-vector \(x\) which minimizes the norm of the residual \(Ax - b\) for an \(m\)-vector \(b\), where \(m > n\):
\[ \min_x \| Ax - b \|^2 \]
In general, because the problem is over-determined, there does not exist an \(x\) which exactly satisifes \(Ax = b\), so we do the next best thing and minimize the residual.
</p>
<p>
We can find the least squares solution via calculus setting the gradient of the cost function to zero:
\[ f(x) = \| Ax - b \|^2 \]
\[ 0 = 2 A^T (A \hat{x} - b) \]
\[ A^T A \hat{x} = A^T b \]
\[ \hat{x} = (A^T A)^{-1} A^T b \]
</p>
The matrix \((A^T A)^{-1} A^T\) is called the pseudo-inverse of \(A\).  Note that the solution \(\hat{x}\) is the projection of \(b\) onto \(A\).  Numerically, the solution can be found using the decomposition \(A = QR\):
\[ A^T A \hat{x} = A^T b \]
\[ R^T Q^T Q R \hat{x} = R^T Q^T b \]
\[ R \hat{x} = Q^T b \]

<h2>Matrix Least Squares</h2>

<h1>Constrained Least Squares</h1>
<p>
The constrained least squares problem is to find an \(n\)-vector \(x\) which minimizes the norm of the residual \(Ax - b\) for an \(m\)-vector \(b\), where \(m > n\), and which satisifies a linear constraint:
\[ \min_x \| Ax - b \|^2 \]
\[\textrm{subject to} \quad C x = d \]
</p>
Similarly to least squares, we can use calculus on the Lagrangian:
\[ L(x) = \| Ax - b \|^2 + z^T(Cx-d) \]
\[ 0 = 2 A^T (A\hat{x} - b) + C^T \hat{z} \]
\[ 0 = 2 A^T A\hat{x} - 2A^T b + C^T \hat{z} \]
We can write the above condition which are called the KKT equations in matrix form:
\[
\begin{bmatrix}
2A^T A & C^T \\
C & 0
\end{bmatrix}
\begin{bmatrix}
\hat{x} \\
\hat{z}
\end{bmatrix}
=
\begin{bmatrix}
2A^T b \\
d
\end{bmatrix}
\]
Numerically, similarly to least squares, we can use a QR decomposition:
\[
\begin{bmatrix}
A \\
C
\end{bmatrix}
=
\begin{bmatrix}
Q_1 \\
Q_2
\end{bmatrix}
\begin{bmatrix}
R
\end{bmatrix}
\]


<h1>Nonlinear Least Squares</h1>
</body>
</html>
